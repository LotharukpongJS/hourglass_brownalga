---
title: "1.3.1 Transformations (DEG)"
output:
  html_document:
    fig_width: 6
    fig_height: 4
    df_print: paged
editor_options: 
  chunk_output_type: inline
---

# Transformations

RNA-seq data transformations can affect the hourglass profile. 
This issue has been brought to attention in [Piasecka et al., 2013 _PLOS Genetics_](https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1003476) and has since been employed by various studies (e.g. [Liu & Robinson-Rechavi, 2018 _GBE_](https://academic.oup.com/gbe/article/10/9/2266/5076813)).

The transformation function (`tf()`) for `myTAI` has been extended in v1.0.1.9000.
Here, we save the transformed data.

Note: `rlog` or `vst` transformations have been done in the previous section `1.2,1 myTAI dataset (dNdS)`. The rational lies therein.

```{r}
library(tidyverse)
library(myTAI)
#  myTAI v1.0.1.9000 2023-07-12 Github (drostlab/myTAI@46eb927)
```

```{r}
Fd_DES <-
  readr::read_csv(file = "data/Fd_DES.csv")
Fd_DES_F <-
  readr::read_csv(file = "data/Fd_DES_F.csv")
Fd_DES_M <-
  readr::read_csv(file = "data/Fd_DES_M.csv")
Fs_DES <-
  readr::read_csv(file = "data/Fs_DES.csv")
Fs_DES_F <-
  readr::read_csv(file = "data/Fs_DES_F.csv")
Fs_DES_M <-
  readr::read_csv(file = "data/Fs_DES_M.csv")
Ec_DES_32m <-
  readr::read_csv(file = "data/Ec_DES_32m.csv")
Ec_DES_25f <-
  readr::read_csv(file = "data/Ec_DES_25f.csv")
# tissues in the matSP
Fd_DES_matSP <-
  readr::read_csv(file = "data/Fd_DES_matSP.csv")
Fs_DES_F_matSP <-
  readr::read_csv(file = "data/Fs_DES_F_matSP.csv")
Fs_DES_M_matSP <-
  readr::read_csv(file = "data/Fs_DES_M_matSP.csv")

# denoised data
Fd_DES.denoised <-
  readr::read_csv(file = "data/Fd_DES_denoised.csv")
Fd_DES_F.denoised <-
  readr::read_csv(file = "data/Fd_DES_F_denoised.csv")
Fd_DES_M.denoised <-
  readr::read_csv(file = "data/Fd_DES_M_denoised.csv")
Fs_DES.denoised <-
  readr::read_csv(file = "data/Fs_DES_denoised.csv")
Fs_DES_F.denoised <-
  readr::read_csv(file = "data/Fs_DES_F_denoised.csv")
Fs_DES_M.denoised <-
  readr::read_csv(file = "data/Fs_DES_M_denoised.csv")
Ec_DES_32m.denoised <-
  readr::read_csv(file = "data/Ec_DES_32m_denoised.csv")
Ec_DES_25f.denoised <-
  readr::read_csv(file = "data/Ec_DES_25f_denoised.csv")

Fd_DES_matSP.denoised <-
  readr::read_csv(file = "data/Fd_DES_matSP_denoised.csv")
Fs_DES_M_matSP.denoised <-
  readr::read_csv(file = "data/Fs_DES_M_matSP_denoised.csv")
Fs_DES_F_matSP.denoised <-
  readr::read_csv(file = "data/Fs_DES_F_matSP_denoised.csv")
```

## Log transformations

```{r}
Fd_DES.log2 <- 
  myTAI::tf(
  ExpressionSet = Fd_DES, 
  FUN = log2,
  pseudocount = 1)
Fd_DES_F.log2 <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_F, 
  FUN = log2,
  pseudocount = 1)
Fd_DES_M.log2 <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_M, 
  FUN = log2,
  pseudocount = 1)
Fs_DES.log2 <- 
  myTAI::tf(
  ExpressionSet = Fs_DES, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_F.log2 <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_M.log2 <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M, 
  FUN = log2,
  pseudocount = 1)
Ec_DES_32m.log2 <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_32m, 
  FUN = log2,
  pseudocount = 1)
Ec_DES_25f.log2 <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_25f, 
  FUN = log2,
  pseudocount = 1)
Fd_DES_matSP.log2 <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_matSP, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_F_matSP.log2 <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F_matSP, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_M_matSP.log2 <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M_matSP, 
  FUN = log2,
  pseudocount = 1)

# denoised data

Fd_DES.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES.denoised, 
  FUN = log2,
  pseudocount = 1)
Fd_DES_F.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_F.denoised, 
  FUN = log2,
  pseudocount = 1)
Fd_DES_M.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_M.denoised, 
  FUN = log2,
  pseudocount = 1)
Fs_DES.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES.denoised, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_F.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F.denoised, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_M.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M.denoised, 
  FUN = log2,
  pseudocount = 1)
Ec_DES_32m.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_32m.denoised, 
  FUN = log2,
  pseudocount = 1)
Ec_DES_25f.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_25f.denoised, 
  FUN = log2,
  pseudocount = 1)
Fd_DES_matSP.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_matSP.denoised, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_F_matSP.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F_matSP.denoised, 
  FUN = log2,
  pseudocount = 1)
Fs_DES_M_matSP.log2.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M_matSP.denoised, 
  FUN = log2,
  pseudocount = 1)
```

## Square-root transformations

```{r}
Fd_DES.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fd_DES, 
  FUN = sqrt)
Fd_DES_F.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_F, 
  FUN = sqrt)
Fd_DES_M.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_M, 
  FUN = sqrt)
Fs_DES.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fs_DES, 
  FUN = sqrt)
Fs_DES_F.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F, 
  FUN = sqrt)
Fs_DES_M.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M, 
  FUN = sqrt)
Ec_DES_32m.sqrt <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_32m, 
  FUN = sqrt)
Ec_DES_25f.sqrt <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_25f, 
  FUN = sqrt)
Fd_DES_matSP.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_matSP, 
  FUN = sqrt)
Fs_DES_F_matSP.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F_matSP, 
  FUN = sqrt)
Fs_DES_M_matSP.sqrt <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M_matSP, 
  FUN = sqrt)

# denoised data

Fd_DES.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES.denoised, 
  FUN = sqrt)
Fd_DES_F.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_F.denoised, 
  FUN = sqrt)
Fd_DES_M.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_M.denoised, 
  FUN = sqrt)
Fs_DES.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES.denoised, 
  FUN = sqrt)
Fs_DES_F.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F.denoised, 
  FUN = sqrt)
Fs_DES_M.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M.denoised, 
  FUN = sqrt)
Ec_DES_32m.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_32m.denoised, 
  FUN = sqrt)
Ec_DES_25f.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_25f.denoised, 
  FUN = sqrt)
Fd_DES_matSP.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_matSP.denoised, 
  FUN = sqrt)
Fs_DES_F_matSP.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F_matSP.denoised, 
  FUN = sqrt)
Fs_DES_M_matSP.sqrt.denoised <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M_matSP.denoised, 
  FUN = sqrt)
```

## Rank transformations

```{r}
Fd_DES.rank <- 
  myTAI::tf(
  ExpressionSet = Fd_DES, 
  FUN = function(x) apply(x, 2, base::rank))
Fd_DES_F.rank <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_F, 
  FUN = function(x) apply(x, 2, base::rank))
Fd_DES_M.rank <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_M, 
  FUN = function(x) apply(x, 2, base::rank))
Fs_DES.rank <- 
  myTAI::tf(
  ExpressionSet = Fs_DES, 
  FUN = function(x) apply(x, 2, base::rank))
Fs_DES_F.rank <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F, 
  FUN = function(x) apply(x, 2, base::rank))
Fs_DES_M.rank <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M, 
  FUN = function(x) apply(x, 2, base::rank))
Ec_DES_32m.rank <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_32m, 
  FUN = function(x) apply(x, 2, base::rank))
Ec_DES_25f.rank <- 
  myTAI::tf(
  ExpressionSet = Ec_DES_25f, 
  FUN = function(x) apply(x, 2, base::rank))
Fd_DES_matSP.rank <- 
  myTAI::tf(
  ExpressionSet = Fd_DES_matSP, 
  FUN = function(x) apply(x, 2, base::rank))
Fs_DES_F_matSP.rank <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_F_matSP, 
  FUN = function(x) apply(x, 2, base::rank))
Fs_DES_M_matSP.rank <- 
  myTAI::tf(
  ExpressionSet = Fs_DES_M_matSP, 
  FUN = function(x) apply(x, 2, base::rank))
```

## rlog transformations

```{r}
# Fd_DES.rlog <-
#   readr::read_csv(file = "data/Fd_DES.rlog.csv")
# Fd_DES_F.rlog <-
#   readr::read_csv(file = "data/Fd_DES_F.rlog.csv")
# Fd_DES_M.rlog <-
#   readr::read_csv(file = "data/Fd_DES_M.rlog.csv")
# Fs_DES.rlog <-
#   readr::read_csv(file = "data/Fs_DES.rlog.csv")
# Fs_DES_F.rlog <-
#   readr::read_csv(file = "data/Fs_DES_F.rlog.csv")
# Fs_DES_M.rlog <-
#   readr::read_csv(file = "data/Fs_DES_M.rlog.csv")
# Ec_DES_32m.rlog <-
#   readr::read_csv(file = "data/Ec_DES_32m.rlog.csv")
# Ec_DES_25f.rlog <-
#   readr::read_csv(file = "data/Ec_DES_25f.rlog.csv")
# 
# Fd_DES_matSP.rlog <-
#   readr::read_csv(file = "data/Fd_DES_matSP.rlog.csv")
# Fs_DES_M_matSP.rlog <-
#   readr::read_csv(file = "data/Fs_DES_M_matSP.rlog.csv")
# Fs_DES_F_matSP.rlog <-
#   readr::read_csv(file = "data/Fs_DES_F_matSP.rlog.csv")
```

# Save transformations

```{r}
Fd_DES.log2 %>%
  readr::write_csv("data/Fd_DES.log2.csv")
Fd_DES.rank %>%
  readr::write_csv("data/Fd_DES.rank.csv")
Fd_DES.sqrt %>%
  readr::write_csv("data/Fd_DES.sqrt.csv")

Fd_DES_F.log2 %>%
  readr::write_csv("data/Fd_DES_F.log2.csv")
Fd_DES_F.rank %>%
  readr::write_csv("data/Fd_DES_F.rank.csv")
Fd_DES_F.sqrt %>%
  readr::write_csv("data/Fd_DES_F.sqrt.csv")

Fd_DES_M.log2 %>%
  readr::write_csv("data/Fd_DES_M.log2.csv")
Fd_DES_M.rank %>%
  readr::write_csv("data/Fd_DES_M.rank.csv")
Fd_DES_M.sqrt %>%
  readr::write_csv("data/Fd_DES_M.sqrt.csv")

Fs_DES.log2 %>%
  readr::write_csv("data/Fs_DES.log2.csv")
Fs_DES.rank %>%
  readr::write_csv("data/Fs_DES.rank.csv")
Fs_DES.sqrt %>%
  readr::write_csv("data/Fs_DES.sqrt.csv")

Fs_DES_M.log2 %>%
  readr::write_csv("data/Fs_DES_M.log2.csv")
Fs_DES_M.rank %>%
  readr::write_csv("data/Fs_DES_M.rank.csv")
Fs_DES_M.sqrt %>%
  readr::write_csv("data/Fs_DES_M.sqrt.csv")

Fs_DES_F.log2 %>%
  readr::write_csv("data/Fs_DES_F.log2.csv")
Fs_DES_F.rank %>%
  readr::write_csv("data/Fs_DES_F.rank.csv")
Fs_DES_F.sqrt %>%
  readr::write_csv("data/Fs_DES_F.sqrt.csv")

Ec_DES_32m.log2 %>%
  readr::write_csv("data/Ec_DES_32m.log2.csv")
Ec_DES_32m.rank %>%
  readr::write_csv("data/Ec_DES_32m.rank.csv")
Ec_DES_32m.sqrt %>%
  readr::write_csv("data/Ec_DES_32m.sqrt.csv")

Ec_DES_25f.log2 %>%
  readr::write_csv("data/Ec_DES_25f.log2.csv")
Ec_DES_25f.rank %>%
  readr::write_csv("data/Ec_DES_25f.rank.csv")
Ec_DES_25f.sqrt %>%
  readr::write_csv("data/Ec_DES_25f.sqrt.csv")

Fd_DES_matSP.log2 %>%
  readr::write_csv("data/Fd_DES_matSP.log2.csv")
Fd_DES_matSP.rank %>%
  readr::write_csv("data/Fd_DES_matSP.rank.csv")
Fd_DES_matSP.sqrt %>%
  readr::write_csv("data/Fd_DES_matSP.sqrt.csv")

Fs_DES_M_matSP.log2 %>%
  readr::write_csv("data/Fs_DES_M_matSP.log2.csv")
Fs_DES_M_matSP.rank %>%
  readr::write_csv("data/Fs_DES_M_matSP.rank.csv")
Fs_DES_M_matSP.sqrt %>%
  readr::write_csv("data/Fs_DES_M_matSP.sqrt.csv")

Fs_DES_F_matSP.log2 %>%
  readr::write_csv("data/Fs_DES_F_matSP.log2.csv")
Fs_DES_F_matSP.rank %>%
  readr::write_csv("data/Fs_DES_F_matSP.rank.csv")
Fs_DES_F_matSP.sqrt %>%
  readr::write_csv("data/Fs_DES_F_matSP.sqrt.csv")

# denoised data

Fd_DES.log2.denoised %>%
  readr::write_csv("data/Fd_DES.log2_denoised.csv")
Fd_DES.sqrt.denoised %>%
  readr::write_csv("data/Fd_DES.sqrt_denoised.csv")

Fd_DES_F.log2.denoised %>%
  readr::write_csv("data/Fd_DES_F.log2_denoised.csv")
Fd_DES_F.sqrt.denoised %>%
  readr::write_csv("data/Fd_DES_F.sqrt_denoised.csv")

Fd_DES_M.log2.denoised %>%
  readr::write_csv("data/Fd_DES_M.log2_denoised.csv")
Fd_DES_M.sqrt.denoised %>%
  readr::write_csv("data/Fd_DES_M.sqrt_denoised.csv")

Fs_DES.log2.denoised %>%
  readr::write_csv("data/Fs_DES.log2_denoised.csv")
Fs_DES.sqrt.denoised %>%
  readr::write_csv("data/Fs_DES.sqrt_denoised.csv")

Fs_DES_M.log2.denoised %>%
  readr::write_csv("data/Fs_DES_M.log2_denoised.csv")
Fs_DES_M.sqrt.denoised%>%
  readr::write_csv("data/Fs_DES_M.sqrt_denoised.csv")

Fs_DES_F.log2.denoised %>%
  readr::write_csv("data/Fs_DES_F.log2_denoised.csv")
Fs_DES_F.sqrt.denoised %>%
  readr::write_csv("data/Fs_DES_F.sqrt_denoised.csv")

Ec_DES_32m.log2.denoised %>%
  readr::write_csv("data/Ec_DES_32m.log2_denoised.csv")
Ec_DES_32m.sqrt.denoised %>%
  readr::write_csv("data/Ec_DES_32m.sqrt_denoised.csv")

Ec_DES_25f.log2.denoised %>%
  readr::write_csv("data/Ec_DES_25f.log2_denoised.csv")
Ec_DES_25f.sqrt.denoised %>%
  readr::write_csv("data/Ec_DES_25f.sqrt_denoised.csv")

Fd_DES_matSP.log2.denoised %>%
  readr::write_csv("data/Fd_DES_matSP.log2_denoised.csv")
Fd_DES_matSP.sqrt.denoised %>%
  readr::write_csv("data/Fd_DES_matSP.sqrt_denoised.csv")

Fs_DES_M_matSP.log2.denoised %>%
  readr::write_csv("data/Fs_DES_M_matSP.log2_denoised.csv")
Fs_DES_M_matSP.sqrt.denoised %>%
  readr::write_csv("data/Fs_DES_M_matSP.sqrt_denoised.csv")

Fs_DES_F_matSP.log2.denoised %>%
  readr::write_csv("data/Fs_DES_F_matSP.log2_denoised.csv")
Fs_DES_F_matSP.sqrt.denoised %>%
  readr::write_csv("data/Fs_DES_F_matSP.sqrt_denoised.csv")
```

Get session info.

```{r}
devtools::session_info()
```
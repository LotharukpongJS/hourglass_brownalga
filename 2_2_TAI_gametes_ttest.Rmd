---
title: "2.2 TAI tissues in Fucus gametes"
output:
  html_document:
    fig_width: 6
    fig_height: 4
    df_print: paged
editor_options: 
  chunk_output_type: inline
---

# TAI profiles of gametes

For TAI profiles for the developmental stages, one can find them in `2.0 TAI profiles`.

```{r}
library(tidyverse)
library(myTAI)
```

Non-transformed

```{r}
# gamete in the matSP
Fd_PES_M <-
  readr::read_csv(file = "data/Fd_PES_M.csv")
Fd_PES_F <-
  readr::read_csv(file = "data/Fd_PES_F.csv")
Fs_PES_F <-
  readr::read_csv(file = "data/Fs_PES_F.csv") %>% dplyr::select(-matSP)
Fs_PES_M <-
  readr::read_csv(file = "data/Fs_PES_M.csv") %>% dplyr::select(-matSP)
```

sqrt-tranformed

```{r}
# gamete in the matSP
Fd_PES_M.sqrt <-
  readr::read_csv(file = "data/Fd_PES_M.sqrt.csv") %>% dplyr::rename(gamete = V1)
Fd_PES_F.sqrt <-
  readr::read_csv(file = "data/Fd_PES_F.sqrt.csv") %>% dplyr::rename(gamete = V1)
Fs_PES_F.sqrt <-
  readr::read_csv(file = "data/Fs_PES_F.sqrt.csv") %>% dplyr::select(-matSP)
Fs_PES_M.sqrt <-
  readr::read_csv(file = "data/Fs_PES_M.sqrt.csv") %>% dplyr::select(-matSP)
```

log2-tranformed

```{r}
# gamete in the matSP
Fd_PES_M.log2 <-
  readr::read_csv(file = "data/Fd_PES_M.log2.csv") %>% dplyr::rename(gamete = V1)
Fd_PES_F.log2 <-
  readr::read_csv(file = "data/Fd_PES_F.log2.csv") %>% dplyr::rename(gamete = V1)
Fs_PES_F.log2 <-
  readr::read_csv(file = "data/Fs_PES_F.log2.csv") %>% dplyr::select(-matSP)
Fs_PES_M.log2 <-
  readr::read_csv(file = "data/Fs_PES_M.log2.csv") %>% dplyr::select(-matSP)
```

rank-tranformed

```{r}
# gamete in the matSP
Fd_PES_M.rank <-
  readr::read_csv(file = "data/Fd_PES_M.rank.csv") %>% dplyr::rename(gamete = V1)
Fd_PES_F.rank <-
  readr::read_csv(file = "data/Fd_PES_F.rank.csv") %>% dplyr::rename(gamete = V1)
Fs_PES_F.rank <-
  readr::read_csv(file = "data/Fs_PES_F.rank.csv") %>% dplyr::select(-matSP)
Fs_PES_M.rank <-
  readr::read_csv(file = "data/Fs_PES_M.rank.csv") %>% dplyr::select(-matSP)
```

rlog-tranformed

```{r}
# gamete in the matSP
Fd_PES_M.rlog <-
  readr::read_csv(file = "data/Fd_PES_M.rlog.csv")
Fd_PES_F.rlog <-
  readr::read_csv(file = "data/Fd_PES_F.rlog.csv")
Fs_PES_F.rlog <-
  readr::read_csv(file = "data/Fs_PES_F.rlog.csv") %>% dplyr::select(-matSP)
Fs_PES_M.rlog <-
  readr::read_csv(file = "data/Fs_PES_M.rlog.csv") %>% dplyr::select(-matSP)
```

```{r}
# created a function to perform t.test from summary statistics (mean and sd and number of permutations)
# This avoids recomputations.
# from https://stackoverflow.com/questions/63056742/independent-sample-t-test-in-r-using-test-statistics-mean-std-dev-count

welch_t_test_from_summary <- function(TAI_M, TAI_F, permutations, alternative = "greater") {
  mean1 = TAI_M$TAI
  sd1 = TAI_M$sd
  n1 = permutations
  mean2 = TAI_F$TAI
  sd2 = TAI_F$sd
  n2 = permutations
  
  # Calculate the standard error for each group
  se1 <- sd1 / sqrt(n1)
  se2 <- sd2 / sqrt(n2)
  
  # Calculate the degrees of freedom using the Welch-Satterthwaite formula
  df <- ((sd1^2 / n1 + sd2^2 / n2)^2) / ((sd1^2 / n1)^2 / (n1 - 1) + (sd2^2 / n2)^2 / (n2 - 1))
  
  # Calculate the t-statistic
  t_stat <- (mean1 - mean2) / sqrt(se1^2 + se2^2)
  
  # Calculate the p-value based on the alternative hypothesis
  if (alternative == "two.sided") {
    p_value <- 2 * pt(abs(t_stat), df = df, lower.tail = FALSE)
  } else if (alternative == "greater") {
    p_value <- pt(t_stat, df = df, lower.tail = FALSE)
  } else if (alternative == "less") {
    p_value <- pt(t_stat, df = df, lower.tail = TRUE)
  } else {
    stop("Invalid alternative hypothesis. Use 'two.sided', 'greater', or 'less'.")
  }
  
  # Return a list containing the t-statistic, degrees of freedom, and p-value
  result <- list(t_statistic = t_stat, degrees_of_freedom = df, p_value = p_value, alternative = alternative)
  return(result)
}

# Example usage:
# welch_t_test_from_summary(Fs_TAI_M, Fs_TAI_F, permutations = permutations)
# where permutations = 500
```

# Gamete-specific TAI

```{r}
#TI stands for transcriptome index
TI.preplot <- function(ExpressionSet, permutations = 500){
  std <- 
    myTAI::bootMatrix(
      ExpressionSet = ExpressionSet, 
      permutations  = permutations) %>% 
    apply(2, stats::sd)
  TI.out <- 
    myTAI::TAI(ExpressionSet) %>%
    tibble::as_tibble(rownames = "Stage", colnames = c("TAI", "PS")) %>% 
    dplyr::bind_cols(as_tibble(std)) %>%
    dplyr::rename(TAI = 2, sd = 3)
  return(TI.out)
}
```

```{r warning=FALSE, message=FALSE}
Fd_TAI_F <- 
  TI.preplot(Fd_PES_F) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M <- 
  TI.preplot(Fd_PES_M) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F <- 
  TI.preplot(Fs_PES_F) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M <- 
  TI.preplot(Fs_PES_M) %>%
  dplyr::mutate(Sex = "M")

# sqrt
Fd_TAI_F.sqrt <- 
  TI.preplot(Fd_PES_F.sqrt) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.sqrt <- 
  TI.preplot(Fd_PES_M.sqrt) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.sqrt <- 
  TI.preplot(Fs_PES_F.sqrt) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.sqrt <- 
  TI.preplot(Fs_PES_M.sqrt) %>%
  dplyr::mutate(Sex = "M")

# log2
Fd_TAI_F.log2 <- 
  TI.preplot(Fd_PES_F.log2) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.log2 <- 
  TI.preplot(Fd_PES_M.log2) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.log2 <- 
  TI.preplot(Fs_PES_F.log2) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.log2 <- 
  TI.preplot(Fs_PES_M.log2) %>%
  dplyr::mutate(Sex = "M")

# rank
Fd_TAI_F.rank <- 
  TI.preplot(Fd_PES_F.rank) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.rank <- 
  TI.preplot(Fd_PES_M.rank) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.rank <- 
  TI.preplot(Fs_PES_F.rank) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.rank <- 
  TI.preplot(Fs_PES_M.rank) %>%
  dplyr::mutate(Sex = "M")

# rlog
Fd_TAI_F.rlog <- 
  TI.preplot(Fd_PES_F.rlog) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.rlog <- 
  TI.preplot(Fd_PES_M.rlog) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.rlog <- 
  TI.preplot(Fs_PES_F.rlog) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.rlog <- 
  TI.preplot(Fs_PES_M.rlog) %>%
  dplyr::mutate(Sex = "M")
```

```{r}
# maybe I could use geom text? Yes, it is possible but I cannot add the position jitter correctly.
plot_gamete_Fd <- function(preplot_out){
  plot_out <- 
    preplot_out %>%
    ggplot2::ggplot(
      aes(
        x = Sex,
        y = TAI,
        group = Stage,
        colour = Sex
        )
      ) +
    ggplot2::geom_point(
      size = 4, 
      position = ggplot2::position_dodge(width=0.9)) +
    ggplot2::geom_errorbar(
      aes(ymin = TAI - sd, ymax = TAI + sd),
      width = 0.1,
      position = ggplot2::position_dodge(width=0.9)) +
    ggplot2::scale_colour_discrete(
      c("#E64B35FF", "#4DBBD5FF"), 
      guide = "none") +
    ggplot2::labs(
      x = "Sex",
      title = "Fucus distichus \n(gamete)",
      colour = NULL
    ) +
    ggplot2::theme_classic()
  return(plot_out)
}

plot_gamete_Fs <- function(preplot_out){
  plot_out <- 
    preplot_out %>%
    ggplot2::ggplot(
      aes(
        x = Sex,
        y = TAI,
        group = Stage,
        colour = Sex
        )
      ) +
    ggplot2::geom_point(
      size = 4, 
      position = ggplot2::position_dodge(width=0.9)) +
    ggplot2::geom_errorbar(
      aes(ymin = TAI - sd, ymax = TAI + sd),
      width = 0.1,
      position = ggplot2::position_dodge(width=0.9)) +
    ggplot2::scale_colour_discrete(
      c("#E64B35FF", "#4DBBD5FF"), 
      guide = "none") +
    ggplot2::labs(
      x = "Sex",
      title = "Fucus serratus \n(gamete)",
      colour = NULL
    ) +
    ggplot2::theme_classic()
  return(plot_out)
}
# https://stackoverflow.com/questions/35654364/ggplot-jitter-geom-errorbar
# `ggplot2::position_jitter(seed = 1)` can also be used.
# https://stackoverflow.com/questions/56816072/position-dodge-and-nudge-y-together
# For colours:
# scales::show_col(ggsci::pal_npg("nrc")(9))
```


```{r, fig.height = 3, fig.width = 1.5}
base::rbind(Fd_TAI_F, Fd_TAI_M) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "TPM")

base::rbind(Fd_TAI_F.sqrt, Fd_TAI_M.sqrt) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "sqrt(TPM)")

base::rbind(Fd_TAI_F.log2, Fd_TAI_M.log2) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "log2(TPM)")

base::rbind(Fd_TAI_F.rank, Fd_TAI_M.rank) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "rank(TPM)")

base::rbind(Fd_TAI_F.rlog, Fd_TAI_M.rlog) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "rlog(TPM)")
```

```{r, fig.height = 3, fig.width = 1.5}
base::rbind(Fs_TAI_F, Fs_TAI_M) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "TPM")

base::rbind(Fs_TAI_F.sqrt, Fs_TAI_M.sqrt) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "sqrt(TPM)")

base::rbind(Fs_TAI_F.log2, Fs_TAI_M.log2) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "log2(TPM)")

base::rbind(Fs_TAI_F.rank, Fs_TAI_M.rank) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "rank(TPM)")

base::rbind(Fs_TAI_F.rlog, Fs_TAI_M.rlog) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "rlog(TPM)")
```

## Perform Welch T Test from summary statistics

Instead of the flat line test like in other analyses.

```{r warning=FALSE, message=FALSE}
permutations = 500

Fd_PES_ttest <-
  tibble::tibble(
    transformation = c("none", "sqrt", "log2", "rlog", "rank"),
    value = c(
            welch_t_test_from_summary(Fd_TAI_M, Fd_TAI_F, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fd_TAI_M.sqrt, Fd_TAI_F.sqrt, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fd_TAI_M.log2, Fd_TAI_F.log2, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fd_TAI_M.rlog, Fd_TAI_F.rlog, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fd_TAI_M.rank, Fd_TAI_F.rank, 
                                      permutations = permutations,alternative = "greater")$p_value
    )
    ) %>%
  dplyr::rename("pval" = value) %>%
  dplyr::mutate(test = "welch_t_test")

Fs_PES_ttest <-
  tibble::tibble(
    transformation = c("none", "sqrt", "log2", "rlog", "rank"),
    value = c(
            welch_t_test_from_summary(Fs_TAI_M, Fs_TAI_F, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fs_TAI_M.sqrt, Fs_TAI_F.sqrt, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fs_TAI_M.log2, Fs_TAI_F.log2, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fs_TAI_M.rlog, Fs_TAI_F.rlog, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fs_TAI_M.rank, Fs_TAI_F.rank, 
                                      permutations = permutations,alternative = "greater")$p_value
    )
    ) %>%
  dplyr::rename("pval" = value) %>%
  dplyr::mutate(test = "welch_t_test")
```

_Fucus distichus_

```{r fig.height = 2.5, fig.width = 3}
Fd_PES_ttest %>%
  ggplot2::ggplot(
    aes(
      y = -log10(pval),
      x = transformation)) +
  ggplot2::geom_col(width = 0.05) +
  ggplot2::geom_point(size = 5) +
  ggplot2::geom_hline(
    yintercept = -log10(0.05),
    colour = "#E64B35FF",
    linetype = 'dashed',
    size = 2
    ) +
  ggplot2::labs(
    title = "Fucus distichus gametes",
    subtitle = "Welch t.test, alternative = \"greater\"",
    x = "Transformation"
  ) +
  ggplot2::coord_flip() +
  ggplot2::theme_classic()
```

_Fucus serratus_

```{r fig.height = 2.5, fig.width = 3}
Fs_PES_ttest %>%
  ggplot2::ggplot(
    aes(
      y = -log10(pval),
      x = transformation)) +
  ggplot2::geom_col(width = 0.05) +
  ggplot2::geom_point(size = 5) +
  ggplot2::geom_hline(
    yintercept = -log10(0.05),
    colour = "#E64B35FF",
    linetype = 'dashed',
    size = 2
    ) +
  ggplot2::labs(
    title = "Fucus serratus gametes",
    subtitle = "Welch t.test, alternative = \"greater\"",
    x = "Transformation"
  ) +
  ggplot2::coord_flip() +
  ggplot2::theme_classic()
```

# denoised data

Non-transformed

```{r}
# gamete in the matSP
Fd_PES_M.denoised <-
  readr::read_csv(file = "data/Fd_PES_M_denoised.csv")
Fd_PES_F.denoised <-
  readr::read_csv(file = "data/Fd_PES_F_denoised.csv")
Fs_PES_F.denoised <-
  readr::read_csv(file = "data/Fs_PES_F_denoised.csv") %>% dplyr::select(-matSP)
Fs_PES_M.denoised <-
  readr::read_csv(file = "data/Fs_PES_M_denoised.csv") %>% dplyr::select(-matSP)
```

sqrt-tranformed

```{r}
# gamete in the matSP
Fd_PES_M.sqrt.denoised <-
  readr::read_csv(file = "data/Fd_PES_M.sqrt_denoised.csv") %>% dplyr::rename(gamete = V1)
Fd_PES_F.sqrt.denoised <-
  readr::read_csv(file = "data/Fd_PES_F.sqrt_denoised.csv") %>% dplyr::rename(gamete = V1)
Fs_PES_F.sqrt.denoised <-
  readr::read_csv(file = "data/Fs_PES_F.sqrt_denoised.csv") %>% dplyr::select(-matSP)
Fs_PES_M.sqrt.denoised <-
  readr::read_csv(file = "data/Fs_PES_M.sqrt_denoised.csv") %>% dplyr::select(-matSP)
```

log2-tranformed

```{r}
# gamete in the matSP
Fd_PES_M.log2.denoised <-
  readr::read_csv(file = "data/Fd_PES_M.log2_denoised.csv") %>% dplyr::rename(gamete = V1)
Fd_PES_F.log2.denoised <-
  readr::read_csv(file = "data/Fd_PES_F.log2_denoised.csv") %>% dplyr::rename(gamete = V1)
Fs_PES_F.log2.denoised <-
  readr::read_csv(file = "data/Fs_PES_F.log2_denoised.csv") %>% dplyr::select(-matSP)
Fs_PES_M.log2.denoised <-
  readr::read_csv(file = "data/Fs_PES_M.log2_denoised.csv") %>% dplyr::select(-matSP)
```


```{r warning=FALSE, message=FALSE}
Fd_TAI_F.denoised <- 
  TI.preplot(Fd_PES_F.denoised) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.denoised <- 
  TI.preplot(Fd_PES_M.denoised) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.denoised <- 
  TI.preplot(Fs_PES_F.denoised) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.denoised <- 
  TI.preplot(Fs_PES_M.denoised) %>%
  dplyr::mutate(Sex = "M")

# sqrt
Fd_TAI_F.sqrt.denoised <- 
  TI.preplot(Fd_PES_F.sqrt.denoised) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.sqrt.denoised <- 
  TI.preplot(Fd_PES_M.sqrt.denoised) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.sqrt.denoised <- 
  TI.preplot(Fs_PES_F.sqrt.denoised) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.sqrt.denoised <- 
  TI.preplot(Fs_PES_M.sqrt.denoised) %>%
  dplyr::mutate(Sex = "M")

# log2
Fd_TAI_F.log2.denoised <- 
  TI.preplot(Fd_PES_F.log2.denoised) %>%
  dplyr::mutate(Sex = "F")
Fd_TAI_M.log2.denoised <- 
  TI.preplot(Fd_PES_M.log2.denoised) %>%
  dplyr::mutate(Sex = "M")
Fs_TAI_F.log2.denoised <- 
  TI.preplot(Fs_PES_F.log2.denoised) %>%
  dplyr::mutate(Sex = "F")
Fs_TAI_M.log2.denoised <- 
  TI.preplot(Fs_PES_M.log2.denoised) %>%
  dplyr::mutate(Sex = "M")
```


```{r, fig.height = 3, fig.width = 1.5}
base::rbind(Fd_TAI_F.denoised, Fd_TAI_M.denoised) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "TPM")

base::rbind(Fd_TAI_F.sqrt.denoised, Fd_TAI_M.sqrt.denoised) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "sqrt(TPM)")

base::rbind(Fd_TAI_F.log2.denoised, Fd_TAI_M.log2.denoised) %>%
  plot_gamete_Fd() + 
  ggplot2::labs(subtitle = "log2(TPM)")
```

```{r, fig.height = 3, fig.width = 1.5}
base::rbind(Fs_TAI_F.denoised, Fs_TAI_M.denoised) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "TPM")

base::rbind(Fs_TAI_F.sqrt.denoised, Fs_TAI_M.sqrt.denoised) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "sqrt(TPM)")

base::rbind(Fs_TAI_F.log2.denoised, Fs_TAI_M.log2.denoised) %>%
  plot_gamete_Fs() + 
  ggplot2::labs(subtitle = "log2(TPM)")
```

## Perform Welch T Test from summary statistics

Instead of the flat line test like in other analyses.

```{r warning=FALSE, message=FALSE}
permutations = 500

Fd_PES_ttest <-
  tibble::tibble(
    transformation = c("none", "sqrt", "log2"),
    value = c(
            welch_t_test_from_summary(Fd_TAI_M.denoised, Fd_TAI_F.denoised, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fd_TAI_M.sqrt.denoised, Fd_TAI_F.sqrt.denoised, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fd_TAI_M.log2.denoised, Fd_TAI_F.log2.denoised, 
                                      permutations = permutations,alternative = "greater")$p_value
    )
    ) %>%
  dplyr::rename("pval" = value) %>%
  dplyr::mutate(test = "welch_t_test")

Fs_PES_ttest <-
  tibble::tibble(
    transformation = c("none", "sqrt", "log2"),
    value = c(
            welch_t_test_from_summary(Fs_TAI_M.denoised, Fs_TAI_F.denoised, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fs_TAI_M.sqrt.denoised, Fs_TAI_F.sqrt.denoised, 
                                      permutations = permutations,alternative = "greater")$p_value,
            welch_t_test_from_summary(Fs_TAI_M.log2.denoised, Fs_TAI_F.log2.denoised, 
                                      permutations = permutations,alternative = "greater")$p_value
    )
    ) %>%
  dplyr::rename("pval" = value) %>%
  dplyr::mutate(test = "welch_t_test")
```

_Fucus distichus_

```{r fig.height = 2.5, fig.width = 3}
Fd_PES_ttest %>%
  ggplot2::ggplot(
    aes(
      y = -log10(pval),
      x = transformation)) +
  ggplot2::geom_col(width = 0.05) +
  ggplot2::geom_point(size = 5) +
  ggplot2::geom_hline(
    yintercept = -log10(0.05),
    colour = "#E64B35FF",
    linetype = 'dashed',
    size = 2
    ) +
  ggplot2::labs(
    title = "Fucus distichus gametes",
    subtitle = "Welch t.test, alternative = \"greater\"",
    x = "Transformation"
  ) +
  ggplot2::coord_flip() +
  ggplot2::theme_classic()
```

_Fucus serratus_

```{r fig.height = 2.5, fig.width = 3}
Fs_PES_ttest %>%
  ggplot2::ggplot(
    aes(
      y = -log10(pval),
      x = transformation)) +
  ggplot2::geom_col(width = 0.05) +
  ggplot2::geom_point(size = 5) +
  ggplot2::geom_hline(
    yintercept = -log10(0.05),
    colour = "#E64B35FF",
    linetype = 'dashed',
    size = 2
    ) +
  ggplot2::labs(
    title = "Fucus serratus gametes",
    subtitle = "Welch t.test, alternative = \"greater\"",
    x = "Transformation"
  ) +
  ggplot2::coord_flip() +
  ggplot2::theme_classic()
```

Get session info.

```{r}
devtools::session_info()
```